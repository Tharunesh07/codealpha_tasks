stock_prices = {"LICI": 890, "NESTLE": 1272, "CIPLA": 1500, "ONGC": 230, "NTPC": 320}


def get_portfolio():
    portfolio = {}
    print("Enter share name and quantity")

    while True:
        share_name = input().upper().strip()
        if share_name == "":
            break
        if share_name not in stock_prices:
            print("enter a valid share_name", ", ".join(stock_prices.keys()))
            continue
        try:
            qty = int(input("Enter quantity to be purchased:"))
        except ValueError:
            print("Enter a valid integer")
            continue
        portfolio[share_name]= portfolio.get(share_name,0 ) + qty  
    return portfolio



def total_portfolio(portfolio):
    total = 0
    for share_name, qty in portfolio.items():
        price_of_a_share = stock_prices[share_name]
        total += qty*price_of_a_share
    return total


def txt_file(portfolio,total,file = "port.txt"):
    with open(file, "w") as f:
        f.write("stock portfolio summary \n")
        for share_name , qty in portfolio.items():
            f.write(f"{share_name}: {qty} shares at {stock_prices[share_name]} = {stock_prices[share_name]* qty}\n ")
            f.write(f"\nTotal Investment: {total}\n")


def csv_file(portfolio,total,file = "port.csv"):
    import csv
    with open(file, "w", newline="") as m:
        writer = csv.writer(m)
        writer.writerow(['share_name','quantity','price','total'])
        for share_name, qty in portfolio.items():
            writer.writerow([share_name, qty , stock_prices[share_name], stock_prices[share_name]* qty])
        writer.writerow([])


def main():
    portfolio = get_portfolio()
    if not  portfolio:
        print("no stocks entered")
        return
    total = total_portfolio(portfolio)
    print( f"\n total investment : {total}\n")

    choice = input("choose in which format you want to save this file(txt/csv): ")
    if choice == "txt":
        txt_file(portfolio,total)
        print("file saved sucessfully")
    elif choice == "csv":
        csv_file(portfolio,total)
        print("saved in csv sucessfully")


if __name__ == "__main__":
    main()